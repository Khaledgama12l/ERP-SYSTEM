<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>نظام إدارة المبيعات </title>
    <link rel="stylesheet" href="style/style.css">
    <link rel="stylesheet" href="style/style2.css">
    <link rel="stylesheet" href="style/style3.css">
    <!-- <link rel="stylesheet" href="style/style4.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon.ico">
</head>
<body>
    <!-- <div id="main-login-overlay">
    
    

    <div class="login-side-form">
        <div class="login-header">
            <h2>مرحباً بك</h2>
            <p>يرجى تسجيل الدخول للمتابعة</p>
        </div>

        <div class="input-group">
            <label>اسم المستخدم</label>
            <input type="text" id="main-username" value="admin" class="login-input">
        </div>

        <div class="input-group">
            <label>كلمة المرور</label>
            <input type="password" id="main-pass" placeholder="••••••••" class="login-input">
        </div>

        <button onclick="checkMainPass()" class="btn-login">
            دخول النظام
        </button>
    </div>
    <div class="login-side-image"></div>
</div> -->


<aside class="sidebar">
    <nav>
        <div class="nav-item active" onclick="showSection('welcome-section')">
            <i class="fas fa-home"></i> <span>الرئيسية</span>
        </div>
        
        <div class="nav-item" onclick="showSection('sales')">
            <i class="fas fa-shopping-cart"></i> <span>فاتورة بيع</span>
        </div>
        
        <div class="nav-item" onclick="showSection('purchase')">
            <i class="fas fa-truck-loading"></i> <span>فاتورة وارد</span>
        </div>
        
        <div class="nav-item" onclick="showSection('reports')">
            <i class="fas fa-history"></i> <span>سجل الفواتير</span>
        </div>
        
        <div class="nav-item"  onclick="checkPassAndShow('inventory', 'inv_pass')"> 
            <i class="fas fa-boxes"></i> <span>المخزن</span>
        </div>
        
        <div class="nav-item" onclick="checkPassAndShow('dashboard-section', 'dash_pass')">
            <i class="fas fa-chart-line"></i> <span>لوحة التحكم</span>
        </div>
        <div class="nav-item" onclick="showSection('settings-section')">
            <i class="fas fa-cog"></i> <span>الإعدادات</span>
        </div>
    </nav>
</aside>
<!-- onclick="showSection('dashboard-section')" 
onclick="showSection('inventory')" -->
    <main class="main-content">
    <section id="welcome-section" class="content-section">
    <div class="welcome-container">
        <div class="welcome-card">
            <div class="company-logo-wrapper">
                <i class="fas fa-layer-group"></i>
            </div>
            
            <h1 id="display-company-name" class="company-title"> إسم</h1>
            <p class="system-subtitle">نظام إدارة المستودعات والمبيعات المتكامل</p>
            
            <div class="welcome-stats-mini">
                <div class="mini-stat">
                    <i class="far fa-calendar-alt"></i>
                    <span id="welcome-date">--/--/----</span>
                    <label>تاريخ اليوم</label>
                </div>
                <div class="mini-stat">
                    <i class="far fa-clock"></i>
                    <span id="welcome-time">--:--</span>
                    <label>الوقت الحالي</label>
                </div>
            </div>

            <div class="quick-access-wrapper">
                <button id="quick-btn-1" class="btn-quick" title="وصول سريع 1">
                    <i class="fas fa-rocket"></i> اختصار 1
                </button>
                <button id="quick-btn-2" class="btn-quick" title="وصول سريع 2">
                    <i class="fas fa-th-large"></i> اختصار 2
                </button>
            </div>
        </div>
    </div>
</section> 
        

        
    <section id="inventory" class="content-section">
    <div class="glass-header">
        <div class="title-area">
            <h1>المخزن</h1>
            <div class="inventory-header">
                <span>العرض الحالي: <b id="current-view-title">كل المخازن</b></span>
            </div>
        </div>
        
        <div class="action-area">
            <button class="btn btn-blue" onclick="openSortModal()">
                <i class="fas fa-filter"></i> فرز
            </button>

            <button class="btn btn-orange" onclick="openWarehouseModal()">
                <i class="fas fa-warehouse"></i> إدارة المخازن
            </button>

            <button class="btn btn-purple" onclick="openCatModal()">
                <i class="fas fa-tags"></i> إدارة الأقسام
            </button>

            <button class="btn btn-green" onclick="openProductModal()">
                <i class="fas fa-plus-circle"></i> إضافة منتج
            </button>
        </div>
    </div>

    <div class="table-container">
        <table id="inventory-table">
            <thead>
                <tr>
                    <th>كود</th>
                    <th>المنتج</th>
                    <th>المخزن</th> <th>القسم</th>
                    <th>الكمية</th>
                    <th>سعر الشراء</th>
                    <th>سعر البيع</th>
                    <th>التاريخ</th> <th>إجراءات</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>
</section> 

<div id="modal-product" class="modal-overlay">
    <div class="modal-content glass-morphism">
        <h2><i class="fas fa-plus-circle"></i> إضافة منتج جديد</h2>
        <div class="grid-form">
            <input type="text" id="p-name" placeholder="اسم المنتج">
            <select id="p-warehouse-select"></select> <select id="p-category-select"></select>  <input type="number" id="p-qty" placeholder="الكمية">
            <input type="number" id="p-buy" placeholder="سعر الشراء">
            <input type="number" id="p-sell" placeholder="سعر البيع">
        </div>
        <div class="modal-footer">
            <button class="btn btn-green" onclick="saveProduct()">حفظ</button>
            <button class="btn btn-red" onclick="closeAllModals()">إلغاء</button>
        </div>
    </div>
</div>

<div id="modal-manage" class="modal-overlay">
    <div class="modal-content glass-morphism">
        <h2 id="manage-title">إدارة</h2>
        <div class="add-area">
            <input type="text" id="new-item-input" placeholder="الأسم الجديد">
            <button class="btn btn-blue" onclick="addNewItem()">إضافة</button>
        </div>
        <ul id="items-list" class="styled-list"></ul>
        <div class="modal-footer">
            <button class="btn btn-red" onclick="closeAllModals()">إغلاق</button>
        </div>
    </div>
</div>

<div id="modal-filter" class="modal-overlay">
    <div class="modal-content glass-morphism">
        <h2><i class="fas fa-filter"></i> الفرز المتقدم</h2>
        <div class="filter-grid">
            <label>المخزن:</label>
            <select id="filter-warehouse"></select>
            <label>القسم:</label>
            <select id="filter-category"></select>
            <label>من تاريخ:</label>
            <input type="date" id="filter-date-from">
            <label>إلى تاريخ:</label>
            <input type="date" id="filter-date-to">
            <label>ترتيب حسب:</label>
            <select id="filter-sort">
                <option value="none">بدون ترتيب</option>
                <option value="price-high">السعر (من الأعلى)</option>
                <option value="price-low">السعر (من الأقل)</option>
                <option value="qty-low">كمية منخفضة</option>
            </select>
        </div>
        <div class="modal-footer">
            <button class="btn btn-blue" onclick="applyAdvancedFilter()">تطبيق الفرز</button>
            <button class="btn btn-red" onclick="closeAllModals()">إلغاء</button>
        </div>
    </div>
</div>



<section id="sales" class="content-section">
    <div class="glass-header">
        <div class="title-area">
            <h1><i class="fas fa-shopping-cart"></i> فاتورة بيع</h1>
        </div>
    </div>

    <div class="invoice-container">
        <div class="invoice-meta-grid top-meta">
            <div class="input-item">
                <label>اسم العميل</label>
                <div class="search-input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" id="sale-customer-name" placeholder="أدخل اسم العميل...">
                </div>
            </div>
            <div class="input-item">
                <label>رقم الهاتف</label>
                <div class="search-input-group">
                    <i class="fas fa-phone"></i>
                    <input type="text" id="sale-customer-phone" placeholder="رقم الهاتف">
                </div>
            </div>
            <div class="input-item">
                <label>طريقة الدفع</label>
                <div class="search-input-group">
                    <i class="fas fa-wallet"></i>
                    <select id="sale-payment-method">
                        <option value="cash">نقدي (Cash)</option>
                        <option value="card">فيزا (Visa)</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="search-section-wrapper">
    <div class="search-box-wrapper" style="flex: 3;">
        <label>البحث عن منتج</label>
        <div class="search-input-group">
            <i class="fas fa-barcode"></i>
            <input type="text" id="sale-search-input" placeholder="ابحث بالاسم أو الباركود..." oninput="saleSearch(this.value)">
        </div>
        <div id="sale-search-results" class="search-results-dropdown"></div>
    </div>

    <div class="qty-box-wrapper" style="flex: 1;">
        <label>الكمية</label>
        <div class="search-input-group">
            <input type="number" id="sale-qty-input" value="1" min="1" onkeydown="if(event.key==='Enter') confirmAddToInvoice()">
            <button class="btn-add-fast" onclick="confirmAddToInvoice()"><i class="fas fa-plus"></i></button>
        </div>
    </div>
</div>
            <div class="invoice-footer">
            <div class="total-display">
                <div class="total-main">
                    <span>إجمالي الفاتورة:</span>
                    <h2 id="sale-grand-total">0.00</h2>
                </div>
            </div>
            <div class="invoice-actions">
                <div class="clear-btn-container" style="position: relative; display: inline-block;">
    <button class="btn btn-clear" onclick="showClearConfirm()">
        <i class="fas fa-trash-alt"></i> مسح الفاتورة
    </button>

    <div id="clear-confirm-pop" class="mini-pop">
        <p>متأكد؟</p>
        <div class="mini-pop-btns">
            <button class="confirm-yes" onclick="saleClearInvoice(true)">نعم</button>
            <button class="confirm-no" onclick="saleClearInvoice(false)">لا</button>
        </div>
    </div>
</div>
                <button class="btn btn-confirm" onclick="saleProcessInvoice()">إتمام العملية</button>
            </div>
        </div>
        <div class="table-container invoice-table-wrapper">
            <table id="sale-invoice-table" class="invoice-table">
                <thead>
                    <tr>
                        <th>المنتج</th>
                        <th>السعر</th>
                        <th>الكمية</th>
                        <th>الإجمالي</th>
                        <th style="width: 40px;"></th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </div>

        
    </div>
</section> 
        
        <section id="purchase" class="content-section">
    <div class="glass-header purchase-header">
        <div class="title-area">
            <h1><i class="fas fa-truck-loading"></i> فاتورة وارد </h1>
        </div>
    </div>

    <div class="invoice-box">
        <div class="modern-card supplier-card">
            <div class="input-group-fixed">
                <label class="field-label">اسم المورد / الشركة</label>
                <i class="fas fa-building icon-left"></i>
                    <input type="text" id="supplier-name" placeholder="ادخل اسم المورد...">
                <div class="input-with-icon">
                    
                </div>
            </div>
        </div>

        <div class="modern-card entry-grid-card">
            <div class="entry-grid">
                <div class="input-field-wrapper search-wrapper">
                    <label class="field-label-sm">المنتج</label>
                    <input type="text" id="purchase-search" placeholder="البحث ..." 
                           oninput="window.searchWithLocation(this.value)" 
                           onkeydown="window.handlePurchaseKeys(event)">
                    <div id="purchase-results" class="search-results-box"></div>
                </div>

                <div class="input-field-wrapper">
                    <label class="field-label-sm">الكمية</label>
                    <input type="number" id="purchase-qty-input" value="1" 
                           onkeydown="window.handlePurchaseKeys(event)" class="text-center">
                </div>

                <div class="input-field-wrapper">
                    <label class="field-label-sm color-buy">سعر الشراء</label>
                    <input type="number" id="purchase-buy-price" value="0" 
                           onkeydown="window.handlePurchaseKeys(event)" class="text-center bg-buy">
                </div>

                <div class="input-field-wrapper">
                    <label class="field-label-sm color-sell">سعر البيع</label>
                    <input type="number" id="purchase-sell-price" value="0" 
                           onkeydown="window.handlePurchaseKeys(event)" class="text-center bg-sell">
                </div>

                <div class="input-field-wrapper">
                    <label class="field-label-sm">المخزن</label>
                    <select id="target-warehouse" class="modern-select">
                        <option value="المخزن الرئيسي">المخزن الرئيسي</option>
                        <option value="مخزن العرض">مخزن العرض</option>
                    </select>
                </div>

                <div class="input-field-wrapper">
                    <label class="field-label-sm">القسم</label>
                    <select id="target-category" class="modern-select"></select>
                </div>

                <button class="add-btn" onclick="addNewItemToPurchaseTable()" 
                        onkeydown="window.handlePurchaseKeys(event)">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
            <div class="invoice-summary-bar">
            <div class="total-display">
                <span class="total-label">إجمالي فاتورة الوارد:</span>
                <h2 id="purchase-final-total" class="total-amount">0.00 <small>ج.م</small></h2>
            </div>
            <button class="btn-approve" onclick="window.processSmartPurchase()">
                <i class="fas fa-file-invoice-dollar"></i> حفظ 
            </button>
        </div>
        <div class="table-container-modern">
            <table id="purchase-table">
                <thead>
                    <tr>
                        <th>المنتج</th>
                        <th>المخزن/القسم</th>
                        <th>سعر الشراء</th>
                        <th>سعر البيع</th>
                        <th>الكمية</th>
                        <th>الإجمالي</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        
    </div>
</section>
<section id="reports" class="content-section" >
    <div class="glass-header">
        <div class="title-area">
            <h1>سجل الفواتير</h1>
        </div>
        
        <div class="filter-area">
            <div class="search-box-history" style="    width: 470px;">
                <i class="fas fa-search"></i>
                <input type="text" id="filter-name" onkeyup="filterInvoices()" placeholder="ابحث باسم المورد أو رقم العملية...">
            </div>

            <div class="row-filters">
                <div class="date-filter">
                    <i class="fas fa-calendar-alt"></i>
                    <input type="date" id="filter-date" onchange="applyAllFilters()">
                </div>

                <div class="filter-buttons">
                    <button class="btn-filter" onclick="setRecordType('الكل', this)">الكل</button>
                   <button class="btn-filter" onclick="setRecordType('وارد', this)">الوارد</button>
                    <button class="btn-filter" onclick="setRecordType('صادر', this)">الصادر</button>
                </div>
            </div>
        </div>
    </div>

    <div class="table-container">
        <table id="reports-table">
            <thead>
                <tr>
                    <th>رقم العملية</th>
                    <th>التاريخ والوقت</th>
                    <th>النوع</th>
                    <th>الطرف الآخر</th>
                    <th>الأصناف</th>
                    <th>الإجمالي</th>
                    <th>إجراءات</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>
</section> 
    <section id="dashboard-section" class="content-section" >
    <div class="glass-header">
        <div class="title-area">
            <h1><i class="fas fa-chart-line"></i> لوحة التحكم والتقارير</h1>
            <p>إدارة الأرباح، المصروفات، وجهات التعامل</p>
        </div>
    </div>

    <div class="dash-grid">
        <div class="card-stat sales-card">
            <div class="card-body"><h3>مبيعات اليوم</h3><h2 id="dash-today-sales">0.00</h2></div>
            <i class="fas fa-shopping-basket"></i>
        </div>
        <div class="card-stat profit-card-daily">
            <div class="card-body"><h3>أرباح اليوم</h3><h2 id="dash-today-profit">0.00</h2></div>
            <i class="fas fa-wallet"></i>
        </div>
        <div class="card-stat profit-card-monthly">
            <div class="card-body"><h3>أرباح الشهر</h3><h2 id="dash-month-profit">0.00</h2></div>
            <i class="fas fa-chart-bar"></i>
        </div>
        <div class="card-stat warning-card">
            <div class="card-body"><h3>نواقص المخزن</h3><h2 id="dash-low-stock">0</h2></div>
            <i class="fas fa-exclamation-triangle"></i>
        </div>
    </div>

    <div class="control-buttons-grid">
        <div class="ctrl-card client-btn" onclick="openPeopleModal('customers')">
            <i class="fas fa-user-friends"></i> <span>قائمة العملاء</span>
        </div>
        <div class="ctrl-card supplier-btn" onclick="openPeopleModal('suppliers')">
            <i class="fas fa-truck-loading"></i> <span>قائمة الموردين</span>
        </div>
        <div class="ctrl-card profit-btn" onclick="openLogsModal('profit')">
            <i class="fas fa-history"></i> <span>سجل الأرباح</span>
        </div>
        <div class="ctrl-card expense-btn" onclick="openLogsModal('expenses')">
            <i class="fas fa-receipt"></i> <span>سجل المصروفات</span>
        </div>
    </div>

    <div class="security-card full-width">
    <div class="security-header"><i class="fas fa-user-shield"></i> <h3>إدارة النظام والشركة</h3></div>
    <div class="security-body">
        <div class="config-section">
            <label class="section-label">اسم الشركة</label>
            <div class="input-with-btn">
                <input type="text" id="new-company-name" placeholder="ادخل اسم الشركة">
                <button class="btn-action save" onclick="updateCompanyName()"><i class="fas fa-check"></i> حفظ</button>
            </div>
        </div>
        <hr class="divider">
        <div class="control-grid">
            <button class="btn-main-action" onclick="toggleUserModal(true)">
                <i class="fas fa-users-cog"></i> إدارة المستخدمين
            </button>
            <button class="btn-main-action secondary" onclick="togglePassModal(true)">
                <i class="fas fa-key"></i> الأرقام السرية للأقسام
            </button>
            <button class="btn-danger-glow" onclick="openResetModal()" style="min-width: 150px;">
        <i class="fas fa-trash-alt" style="font-size: 1.2rem;"></i>
        <span>إعادة تهيئة النظام</span>
    </button>
        </div>
    </div>
</div>
</section>
    <section id="settings-section" class="content-section">
    <div class="glass-header">
        <h1><i class="fas fa-tools"></i> إعدادات المنظومة</h1>
    </div>

    <div class="settings-grid">
        <div class="setting-card">
            <div class="setting-icon"><i class="fas fa-percentage"></i></div>
            <div class="setting-info">
                <h3>الخصم الافتراضي</h3>
                <p>نسبة الخصم التي تظهر تلقائياً في الفواتير</p>
                <div class="input-group">
                    <input type="number" id="set-discount-input" placeholder="0">
                    <button onclick="saveDefaultDiscount()"><i class="fas fa-save"></i></button>
                </div>
            </div>
        </div>

        <div class="setting-card full-width">
            <h3><i class="fas fa-database"></i> إدارة النسخ الاحتياطية</h3>
            <div class="db-actions">
                <button class="db-btn export" onclick="exportDatabase()">
                    <i class="fas fa-cloud-download-alt"></i> تصدير نسخة احتياطية (Export)
                </button>

                <div class="import-wrapper">
                    <button class="db-btn import" onclick="document.getElementById('import-file').click()">
                        <i class="fas fa-cloud-upload-alt"></i> استيراد نسخة قديمة (Import)
                    </button>
                    <input type="file" id="import-file" style="display:none" onchange="importDatabase(event)">
                </div>
            </div>
        </div>
    </div>
</section>

<div id="people-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header"><h3 id="modal-title">القائمة</h3><span class="close" onclick="closePeopleModal()">&times;</span></div>
        <div class="modal-search"><i class="fas fa-search"></i><input type="text" id="modal-search-input" onkeyup="filterModalList()" placeholder="بحث عن اسم..."></div>
        <ul id="modal-items-list" class="modal-list-body"></ul>
    </div>
</div>


   </main>

    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('productModal')">&times;</span>
            <h2 id="modal-title">إضافة منتج</h2>
            <input type="hidden" id="edit-id">
            <div class="input-group">
                <input type="text" id="m-name" placeholder="اسم المنتج">
                <select id="m-category" class="fancy-select"></select>
                <div class="row">
                    <input type="number" id="m-buy" placeholder="سعر الشراء">
                    <input type="number" id="m-sell" placeholder="سعر البيع">
                </div>
                <input type="number" id="m-qty" placeholder="الكمية">
                <button class="btn btn-blue" onclick="saveProduct()">حفظ المنتج</button>
            </div>
        </div>
    </div>

    <div id="catModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('catModal')">&times;</span>
            <h2>إدارة الأقسام</h2>
            <div class="input-group row">
                <input type="text" id="new-cat-name" placeholder="اسم القسم الجديد" style="flex:1">
                <button class="btn btn-purple" onclick="saveCategory()">إضافة</button>
            </div>
            <div class="table-container" style="max-height: 250px;">
                <table>
                    <thead><tr><th>القسم</th><th>حذف</th></tr></thead>
                    <tbody id="cat-list-body"></tbody>
                </table>
            </div>
        </div>
    </div>
    <div id="password-modal" class="modal">
    <div class="modal-content auth-modal">
        <div class="auth-icon"><i class="fas fa-lock"></i></div>
        <h3>منطقة محمية</h3>
        <p id="modal-msg">يرجى إدخال كلمة المرور للدخول</p>
        <div class="input-group">
            <input type="password" id="section-pass-input" placeholder="كلمة المرور هنا...">
        </div>
        <div class="modal-actions">
            <button class="btn btn-blue" onclick="verifySectionPass()">دخول</button>
            <button class="btn btn-delete" onclick="closePassModal()">إلغاء</button>
        </div>
    </div>
</div>
<div class="status-bar">
    <div id="live-clock"></div>
    <div id="user">المستخدم: مدير النظام</div>
    <div class="status-online">متصل (قاعدة بيانات محلية)</div>
</div>
<div id="people-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-title">قائمة العملاء</h3>
            <button class="close-modal" onclick="closePeopleModal()">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="search-wrapper">
                <i class="fas fa-search"></i>
                <input type="text" id="modal-search-input" onkeyup="filterModalList()" placeholder="ابدأ الكتابة للبحث...">
            </div>
            
            <ul id="modal-items-list" class="modal-list">
                </ul>
                
        </div>
    </div>
</div>

<div id="reset-modal" class="modal">
    <div class="modal-content" style="max-width: 450px; border-radius: 20px; border: none; overflow: hidden;">
        <div class="modal-header" style="background: linear-gradient(45deg, #c0392b, #e74c3c); color: white; padding: 20px; text-align: center;">
            <h2 style="margin:0; font-size: 1.4rem;"><i class="fas fa-radiation"></i> مركز التحكم في البيانات</h2>
        </div>
        <div class="modal-body" style="padding: 25px; background: #f9f9f9;">
            <div class="reset-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px;">
                <label class="reset-card"><input type="checkbox" class="reset-chk" value="warehouses"> المخازن</label>
                <label class="reset-card"><input type="checkbox" class="reset-chk" value="categories"> الأقسام</label>
                <label class="reset-card"><input type="checkbox" class="reset-chk" value="products"> المنتجات</label>
                <label class="reset-card"><input type="checkbox" class="reset-chk" value="customers"> العملاء</label>
                <label class="reset-card"><input type="checkbox" class="reset-chk" value="suppliers"> الموردين</label>
                <label class="reset-card"><input type="checkbox" class="reset-chk" value="purchase_history"> سجل المشتريات</label>
<label class="reset-card">
    <input type="checkbox" class="reset-chk" value="sales_history" id="chk-sales" onclick="syncResetFields('sales')"> سجل المبيعات
</label>

<label class="reset-card">
    <input type="checkbox" class="reset-chk" value="profit_logs" id="chk-profit" onclick="syncResetFields('profit')"> الأرباح
</label>
            </div>

            <div style="border-top: 2px dashed #ddd; margin: 15px 0; padding-top: 15px;">
                <label style="color: #c0392b; font-weight: bold; cursor: pointer;">
                    <input type="checkbox" id="full-reset-chk" onchange="toggleFullReset(this)"> <i class="fas fa-bomb"></i> إعادة تهيئة كاملة للنظام
                </label>
            </div>

            <div style="margin-top: 15px;">
                <input type="password" id="reset-pass-input" placeholder="كلمة سر الإدارة للتأكيد" 
                       style="width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 10px; outline: none; transition: 0.3s;">
            </div>
        </div>
        <div class="modal-footer" style="padding: 20px; background: #fff; display: flex; gap: 10px;">
            <button class="action-btn delete" style="flex: 2; height: 45px; font-weight: bold;" onclick="executeSystemReset()">تأكيد العملية</button>
            <button class="action-btn" style="flex: 1; background: #95a5a6;" onclick="closeModal('reset-modal')">تراجع</button>
        </div>
    </div>
</div>
<div id="user-management-modal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-users-cog"></i> إدارة مستخدمي النظام</h3>
            <button class="close-btn" onclick="toggleUserModal(false)">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="user-entry-form">
                <input type="hidden" id="edit-user-id">
                <div class="input-row">
                    <input type="text" id="manage-user-name" placeholder="اسم المستخدم">
                    <input type="password" id="manage-user-pass" placeholder="كلمة المرور">
                </div>
                
                <div class="modal-btns-grid">
                    <div id="edit-actions" style="display:none; gap:10px;">
    <button class="btn-success" onclick="updateUser()">حفظ التعديل</button>
    <button class="btn-secondary" onclick="resetUserForm()">إلغاء</button>
</div>

                    <button id="btn-add-user" class="btn-modal btn-add-new" onclick="addUser()">
                        <i class="fas fa-plus"></i> إضافة مستخدم
                    </button>
                    
                    <button id="btn-update-user" class="btn-modal btn-save-edit" style="display:none;" onclick="updateUser()">
                        <i class="fas fa-save"></i> حفظ التعديل
                    </button>
                    <button id="btn-cancel-edit" class="btn-modal btn-cancel-modal" style="display:none;" onclick="resetUserForm()">
                        إلغاء
                    </button>
                </div>
            </div>

            <div class="user-table-container">
                <table class="user-table">
                    <thead>
                        <tr>
                            <th>التحكم</th>
                            <th>المستخدم</th>
                        </tr>
                    </thead>
                    <tbody id="users-list-table">
                        </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div id="pass-management-modal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-key"></i> الأرقام السرية للأقسام</h3>
            <button class="close-btn" onclick="togglePassModal(false)">&times;</button>
        </div>
        <div class="modal-body">
            <div class="user-entry-form">
    <label>باسوورد المخزن</label>
    <input type="password" id="new-inv-pass" placeholder="اتركه فارغاً لعدم التغيير">
    
    <label style="margin-top:10px; display:block;">باسوورد لوحة التحكم</label>
    <input type="password" id="new-dash-pass" placeholder="اتركه فارغاً لعدم التغيير">
    
    <button class="btn-primary" onclick="saveSystemPass()" style="margin-top:20px; width:100%;">
        <i class="fas fa-save"></i> حفظ التغييرات
    </button>
</div>
        </div>
    </div>
</div>
<div id="section-auth-modal" class="modal-overlay" style="display:none; z-index: 9999;">
    <div class="modal-content" style="width: 300px; text-align: center;">
        <div class="modal-header">
            <h3><i class="fas fa-lock"></i> دخول آمن</h3>
        </div>
        <div class="modal-body">
            <p id="auth-message" style="margin-bottom: 15px; font-size: 0.9rem; color: #666;">برجاء إدخال كلمة السر</p>
            <input type="password" id="auth-section-pass" class="login-input" placeholder="••••" 
                   style="width: 100%; text-align: center; font-size: 1.5rem; letter-spacing: 5px;">
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn-primary" id="confirm-auth-btn" style="flex: 2;">دخول</button>
                <button class="btn-secondary" onclick="closeAuthModal()" style="flex: 1;">إلغاء</button>
            </div>
        </div>
    </div>
</div>
<div id="logs-modal" class="modal">
    <div class="modal-content" style="max-width: 600px; border-radius: 15px;">
        <div class="modal-header" style="background: #27ae60; color: white; padding: 15px; border-radius: 15px 15px 0 0;">
            <h2 id="logs-modal-title" style="margin:0; font-size: 1.2rem;"></h2>
            <button class="close-btn" onclick="closeModal('logs-modal')" style="color:white; background:none; border:none; font-size: 1.5rem; cursor:pointer;">&times;</button>
        </div>
        <div class="modal-body" id="logs-modal-body" style="padding: 20px; max-height: 450px; overflow-y: auto;">
    <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; background: #f9f9f9; padding: 10px; border-radius: 8px;">
    <input type="text" id="logGeneralSearch" oninput="liveSearchLogs()" placeholder="ابحث بالتاريخ (2026-02) أو بالمبلغ..." style="flex: 2; padding: 8px; border: 1px solid #ddd; border-radius: 5px; text-align: right;">
    
    <button onclick="openLogsModal('profit', 'day')" style="flex: 0.5; padding: 8px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">يومي</button>
    <button onclick="openLogsModal('profit', 'month')" style="flex: 0.5; padding: 8px; background: #2980b9; color: white; border: none; border-radius: 5px; cursor: pointer;">شهري</button>
</div>>

    <div id="logs-table-container"></div>
</div>
        <div class="modal-footer" style="padding: 15px; text-align: left;">
            <button class="action-btn" style="background: #95a5a6;" onclick="closeModal('logs-modal')">إغلاق</button>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/sql-wasm.js"></script>
    <!-- <script src="js/script.js"></script> -->
    <!-- <script src="js/script2.js"></script> -->
    <!-- <script src="js/script3.js"></script> -->
    <script src="js/script4.js"></script>
    <script src="js/setting.js"></script>

</body>
</html>